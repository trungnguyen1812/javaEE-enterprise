<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">

    <h:head>
        <title>Facelet Title</title>
    </h:head>
    <h:body>
        <ui:composition template="/Template/client/layout.xhtml">
            <ui:define name="contents">
                <h:form id="cart">
                    <div id="shopping-cart">
                        <div class="txt-heading"><h2>Shopping Cart</h2></div>
                        <h:commandLink id="btnEmpty" value="Empty Cart" action="#{cartProcessMB.clearnCart()}" class="btnEmpty"/>                
                        <c:choose>
                            <c:when test="${empty cartProcessMB.cartMap}">
                                <div class="no-records">Your Cart is Empty</div>
                            </c:when>
                            <c:otherwise>                    
                                <c:set var="total_quantity" value="0" />                                              
                                <c:set var="total_price" value="0"/>
                                <h:dataTable value="#{cartProcessMB.cartMap.entrySet()}" var="iCart" class="tbl-cart" cellpadding="10" cellspacing="1" columnClasses="none,none,none,none,tbl-cartprice,tbl-cartprice,none" style="float: left">
                                    <h:column>
                                        <f:facet name="header">Product ID</f:facet>
                                            #{iCart.key.productID}
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">Image</f:facet>
                                        <h:graphicImage value="assets/img/#{iCart.key.picture}" alt="Image Product" class="cart-item-image"/>
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">Product Name</f:facet>
                                            #{iCart.key.productName}
                                    </h:column>
                                    <h:column>
                                        <div style="">
                                            <f:facet name="header"> Quantity</f:facet>
                                            <h:commandButton value=" - " action="#{cartProcessMB.decreaseCart(iCart.key.productID,iCart.value-1)}" class="btn btn-primary btn-sm" style="width: 50px;height: 27px;float: left"/> 
                                            &nbsp;<h:inputText id="quantity" value="#{iCart.value}" maxlength="4" size="4" readonly="true" style="width: 70px"/>&nbsp;
                                            <h:commandButton value=" + " action="#{cartProcessMB.increaseCart(iCart.key.productID,iCart.value+1)}" class="btn btn-primary btn-sm" style="width: 50px;height: 27px;"/>
                                            <f:facet name="footer">
                                                <h:outputText value="Total Products: #{cartProcessMB.sumProductCart()}" />
                                            </f:facet>
                                        </div>

                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">Unit Price</f:facet>
                                        <h:outputText value="#{iCart.key.price}" style="float: left">
                                            <f:convertNumber currencySymbol = "$" type = "currency" />
                                        </h:outputText>   

                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">Price</f:facet> 
                                        <h:outputText value="#{iCart.value * iCart.key.price}" style="float: left"> 
                                            <f:convertNumber currencySymbol = "$" type = "currency" />
                                        </h:outputText>                                                                
                                        <f:facet name="footer">
                                            <h:outputText value="Total Price:" style="float:left"/>
                                            <h:outputText value="#{cartProcessMB.sumCart()}" style="float:right">
                                                <f:convertNumber currencySymbol = "$" type = "currency" />
                                            </h:outputText>
                                        </f:facet>
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">Remove</f:facet>
                                        <h:commandLink class="btnRemoveAction" action="#{cartProcessMB.removeItemCart(iCart.key.productID)}">
                                            Delete
                                        </h:commandLink>
                                    </h:column>

                                </h:dataTable>  

                            </c:otherwise>  
                        </c:choose>            
                        <div class="no-records">
                            <p class="card-text">
                                <h:commandLink class="btn btn-primary btn-sm" action="shop" value="CONTINUOUS SHOPPING"/>                        
                            </p>
                        </div>
                    </div>
                </h:form>
            </ui:define>
        </ui:composition>

    </h:body>
</html>
